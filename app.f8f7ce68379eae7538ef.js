(()=>{"use strict";(()=>{function e(){}function t(e){return e()}function n(){return Object.create(null)}function s(e){e.forEach(t)}function o(e){return"function"==typeof e}function i(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function r(e){return 0===Object.keys(e).length}function c(e,t,n,s){return e[1]&&s?function(e,t){for(const n in t)e[n]=t[n];return e}(n.ctx.slice(),e[1](s(t))):n.ctx}function a(e,t){e.appendChild(t)}function l(e,t,n){e.insertBefore(t,n||null)}function u(e){e.parentNode.removeChild(e)}function d(e){return document.createElement(e)}function p(e){return document.createTextNode(e)}function f(){return p(" ")}function m(){return p("")}function h(e,t,n,s){return e.addEventListener(t,n,s),()=>e.removeEventListener(t,n,s)}function $(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}let g;function y(e){g=e}function v(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach((e=>e(t)))}new Set,new Set;const b=[],k=[],w=[],M=[],_=Promise.resolve();let x=!1;function C(e){w.push(e)}let A=!1;const N=new Set;function E(){if(!A){A=!0;do{for(let e=0;e<b.length;e+=1){const t=b[e];y(t),U(t.$$)}for(y(null),b.length=0;k.length;)k.pop()();for(let e=0;e<w.length;e+=1){const t=w[e];N.has(t)||(N.add(t),t())}w.length=0}while(b.length);for(;M.length;)M.pop()();x=!1,A=!1,N.clear()}}function U(e){if(null!==e.fragment){e.update(),s(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(C)}}const R=new Set;let T,S;function H(){T={r:0,c:[],p:T}}function P(){T.r||s(T.c),T=T.p}function z(e,t){e&&e.i&&(R.delete(e),e.i(t))}function I(e,t,n,s){if(e&&e.o){if(R.has(e))return;R.add(e),T.c.push((()=>{R.delete(e),s&&(n&&e.d(1),s())})),e.o(t)}}function L(e){e&&e.c()}function j(e,n,i,r){const{fragment:c,on_mount:a,on_destroy:l,after_update:u}=e.$$;c&&c.m(n,i),r||C((()=>{const n=a.map(t).filter(o);l?l.push(...n):s(n),e.$$.on_mount=[]})),u.forEach(C)}function K(e,t){const n=e.$$;null!==n.fragment&&(s(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function B(t,o,i,r,c,a,l=[-1]){const d=g;y(t);const p=t.$$={fragment:null,ctx:null,props:a,update:e,not_equal:c,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(d?d.$$.context:o.context||[]),callbacks:n(),dirty:l,skip_bound:!1};let f=!1;if(p.ctx=i?i(t,o.props||{},((e,n,...s)=>{const o=s.length?s[0]:n;return p.ctx&&c(p.ctx[e],p.ctx[e]=o)&&(!p.skip_bound&&p.bound[e]&&p.bound[e](o),f&&function(e,t){-1===e.$$.dirty[0]&&(b.push(e),x||(x=!0,_.then(E)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}(t,e)),n})):[],p.update(),f=!0,s(p.before_update),p.fragment=!!r&&r(p.ctx),o.target){if(o.hydrate){const e=(m=o.target,Array.from(m.childNodes));p.fragment&&p.fragment.l(e),e.forEach(u)}else p.fragment&&p.fragment.c();o.intro&&z(t.$$.fragment),j(t,o.target,o.anchor,o.customElement),E()}var m;y(d)}"undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global,new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]),"function"==typeof HTMLElement&&(S=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const{on_mount:e}=this.$$;this.$$.on_disconnect=e.map(t).filter(o);for(const e in this.$$.slotted)this.appendChild(this.$$.slotted[e])}attributeChangedCallback(e,t,n){this[e]=n}disconnectedCallback(){s(this.$$.on_disconnect)}$destroy(){K(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){this.$$set&&!r(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}});class J{$destroy(){K(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){this.$$set&&!r(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}class q{constructor(e){this.kosyClient=window.parent,this.latestMessageNumber=0,this.kosyApp=e}startApp(){return this.initialInfoPromise=new Promise(((e,t)=>{window.addEventListener("message",(t=>{let n=t.data;switch(n.type){case"receive-initial-info":e(n.payload),this.latestMessageNumber=n.latestMessageNumber;break;case"client-has-joined":this.kosyApp.onClientHasJoined(n.clientInfo);break;case"client-has-left":this.kosyApp.onClientHasLeft(n.clientUuid);break;case"get-app-state":const t=this.kosyApp.onRequestState();this._sendMessageToKosy({type:"receive-app-state",state:t,clientUuids:n.clientUuids,latestMessageNumber:this.latestMessageNumber});break;case"set-app-state":this.kosyApp.onProvideState(n.state),this.latestMessageNumber=n.latestMessageNumber;break;case"receive-message-as-host":this._handleReceiveMessageAsHost(n);break;case"receive-message-as-client":this._handleReceiveMessageAsClient(n)}})),this._sendMessageToKosy({type:"ready-and-listening"})})),this.initialInfoPromise}stopApp(){this._sendMessageToKosy({type:"stop-app"})}relayMessage(e){this._sendMessageToKosy({type:"relay-message-to-host",message:e})}_sendMessageToKosy(e){this.kosyClient.postMessage(e,"*")}_handleReceiveMessageAsClientRecursive(e,t,n){this.latestMessageNumber===e.messageNumber-(t.currentClientUuid===e.sentByClientUuid?0:1)?(this.kosyApp.onReceiveMessageAsClient(e.message),this.latestMessageNumber=e.messageNumber):n<50&&this.latestMessageNumber<e.messageNumber&&setTimeout((()=>this._handleReceiveMessageAsClientRecursive(e,t,n+1)),100)}_handleReceiveMessageAsClient(e){this.initialInfoPromise.then((t=>{this._handleReceiveMessageAsClientRecursive(e,t,0)}))}_handleReceiveMessageAsHost(e){this.initialInfoPromise.then((t=>{const n=this.kosyApp.onReceiveMessageAsHost(e.message);n&&this._sendMessageToKosy({type:"relay-message-to-clients",sentByClientUuid:t.currentClientUuid,message:n,messageNumber:++this.latestMessageNumber})}))}}function O(t){let n,s;return{c(){n=d("iframe"),$(n,"title","miro board"),n.src!==(s=t[0])&&$(n,"src",s),$(n,"class","svelte-tbe2c")},m(e,t){l(e,n,t)},p(e,[t]){1&t&&n.src!==(s=e[0])&&$(n,"src",s)},i:e,o:e,d(e){e&&u(n)}}}function F(e,t,n){let{url:s}=t;return e.$$set=e=>{"url"in e&&n(0,s=e.url)},[s]}const W=class extends J{constructor(e){super(),B(this,e,F,O,i,{url:0})}};function D(e){let t,n,o,i;const r=e[4].default,a=function(e,t,n,s){if(e){const s=c(e,t,n,null);return e[0](s)}}(r,e,e[3]);return{c(){t=d("button"),a&&a.c(),$(t,"class",e[0])},m(s,r){l(s,t,r),a&&a.m(t,null),n=!0,o||(i=[h(t,"click",e[5]),h(t,"dblclick",e[6]),h(t,"focus",e[7])],o=!0)},p(e,[s]){a&&a.p&&(!n||8&s)&&function(e,t,n,s,o,i,r){const a=function(e,t,n,s){if(e[2]&&s){const o=e[2](s(n));if(void 0===t.dirty)return o;if("object"==typeof o){const e=[],n=Math.max(t.dirty.length,o.length);for(let s=0;s<n;s+=1)e[s]=t.dirty[s]|o[s];return e}return t.dirty|o}return t.dirty}(t,s,o,null);if(a){const o=c(t,n,s,null);e.p(o,a)}}(a,r,e,e[3],s),(!n||1&s)&&$(t,"class",e[0])},i(e){n||(z(a,e),n=!0)},o(e){I(a,e),n=!1},d(e){e&&u(t),a&&a.d(e),o=!1,s(i)}}}function G(e,t,n){let{$$slots:s={},$$scope:o}=t,{size:i}=t,{importance:r}=t,c="";return e.$$set=e=>{"size"in e&&n(1,i=e.size),"importance"in e&&n(2,r=e.importance),"$$scope"in e&&n(3,o=e.$$scope)},e.$$.update=()=>{if(6&e.$$.dirty){let e=[];i?e.push("size-"+i):e.push("size-regular"),r&&e.push("importance-"+r),n(0,c=["re-button",...e].join(" "))}},[c,i,r,o,s,function(t){v(e,t)},function(t){v(e,t)},function(t){v(e,t)}]}const Q=class extends J{constructor(e){super(),B(this,e,G,D,i,{size:1,importance:2})}},V=JSON.parse('{"J":{"I":"3074457356743178263","E":"https://advjhn6mca.execute-api.eu-central-1.amazonaws.com/get-miro-jwt-token"}}');function X(e){let t;return{c(){t=p("Select a miro board")},m(e,n){l(e,t,n)},d(e){e&&u(t)}}}function Y(e){let t,n,s,o,i,r,c;return r=new Q({props:{importance:"secondary",$$slots:{default:[X]},$$scope:{ctx:e}}}),r.$on("click",e[0]),{c(){t=d("div"),n=d("div"),n.innerHTML="<h3>Embed Miro</h3>",s=f(),o=d("div"),i=f(),L(r.$$.fragment),$(n,"class","svelte-1y5yvi7"),$(o,"class","gap svelte-1y5yvi7"),$(t,"class","picking svelte-1y5yvi7")},m(e,u){l(e,t,u),a(t,n),a(t,s),a(t,o),a(t,i),j(r,t,null),c=!0},p(e,[t]){const n={};4&t&&(n.$$scope={dirty:t,ctx:e}),r.$set(n)},i(e){c||(z(r.$$.fragment,e),c=!0)},o(e){I(r.$$.fragment,e),c=!1},d(e){e&&u(t),K(r)}}}function Z(e){const t=function(){const e=function(){if(!g)throw new Error("Function called outside component initialization");return g}();return(t,n)=>{const s=e.$$.callbacks[t];if(s){const o=function(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}(t,n);s.slice().forEach((t=>{t.call(e,o)}))}}}();return[()=>{window.miroBoardsPicker.open({clientId:V.J.I,action:"select",allowCreateAnonymousBoards:!1,getToken:()=>fetch(V.J.E).then((e=>e.text())),success:e=>{console.log("on success",e),t("message",{type:"miro-url-picked",payload:`https://miro.com/app/live-embed/${e.id}`})},error:e=>{console.log("on error",e)},cancel:()=>{console.log("on cancel")}})}]}const ee=class extends J{constructor(e){super(),B(this,e,Z,Y,i,{})}};function te(t){let n,s,o,i,r,c,m,h,g,y,v;return{c(){n=d("div"),s=d("h3"),s.textContent="Miro sharing",o=f(),i=d("p"),r=p("Waiting for "),c=p(t[0]),m=p(" to pick a file"),h=f(),g=d("div"),y=f(),v=d("div"),v.innerHTML='<img alt="waiting" src="assets/waiting.svg"/>',$(g,"class","gap svelte-168y7ua"),$(v,"class","img-container svelte-168y7ua"),$(n,"class","waiting svelte-168y7ua")},m(e,t){l(e,n,t),a(n,s),a(n,o),a(n,i),a(i,r),a(i,c),a(i,m),a(n,h),a(n,g),a(n,y),a(n,v)},p(e,[t]){var n,s;1&t&&(n=c,s=""+(s=e[0]),n.wholeText!==s&&(n.data=s))},i:e,o:e,d(e){e&&u(n)}}}function ne(e,t,n){let{name:s}=t;return e.$$set=e=>{"name"in e&&n(0,s=e.name)},[s]}const se=class extends J{constructor(e){super(),B(this,e,ne,te,i,{name:0})}};function oe(t){let n;return{c(){n=d("p")},m(e,t){l(e,n,t)},p:e,i:e,o:e,d(e){e&&u(n)}}}function ie(e){let t,n,s,o;const i=[ae,ce,re],r=[];function c(e,t){return e[0].miroUrl?0:e[1].clientUuid===e[2].clientUuid?1:2}return t=c(e),n=r[t]=i[t](e),{c(){n.c(),s=m()},m(e,n){r[t].m(e,n),l(e,s,n),o=!0},p(e,o){let a=t;t=c(e),t===a?r[t].p(e,o):(H(),I(r[a],1,1,(()=>{r[a]=null})),P(),n=r[t],n?n.p(e,o):(n=r[t]=i[t](e),n.c()),z(n,1),n.m(s.parentNode,s))},i(e){o||(z(n),o=!0)},o(e){I(n),o=!1},d(e){r[t].d(e),e&&u(s)}}}function re(e){let t,n;return t=new se({props:{name:e[1].clientName}}),{c(){L(t.$$.fragment)},m(e,s){j(t,e,s),n=!0},p(e,n){const s={};2&n&&(s.name=e[1].clientName),t.$set(s)},i(e){n||(z(t.$$.fragment,e),n=!0)},o(e){I(t.$$.fragment,e),n=!1},d(e){K(t,e)}}}function ce(t){let n,s;return n=new ee({}),n.$on("message",t[4]),{c(){L(n.$$.fragment)},m(e,t){j(n,e,t),s=!0},p:e,i(e){s||(z(n.$$.fragment,e),s=!0)},o(e){I(n.$$.fragment,e),s=!1},d(e){K(n,e)}}}function ae(e){let t,n;return t=new W({props:{url:e[0].miroUrl}}),{c(){L(t.$$.fragment)},m(e,s){j(t,e,s),n=!0},p(e,n){const s={};1&n&&(s.url=e[0].miroUrl),t.$set(s)},i(e){n||(z(t.$$.fragment,e),n=!0)},o(e){I(t.$$.fragment,e),n=!1},d(e){K(t,e)}}}function le(e){let t,n,s,o;const i=[ie,oe],r=[];function c(e,t){return e[1]&&e[2]?0:1}return t=c(e),n=r[t]=i[t](e),{c(){n.c(),s=m()},m(e,n){r[t].m(e,n),l(e,s,n),o=!0},p(e,[o]){let a=t;t=c(e),t===a?r[t].p(e,o):(H(),I(r[a],1,1,(()=>{r[a]=null})),P(),n=r[t],n?n.p(e,o):(n=r[t]=i[t](e),n.c()),z(n,1),n.m(s.parentNode,s))},i(e){o||(z(n),o=!0)},o(e){I(n),o=!1},d(e){r[t].d(e),e&&u(s)}}}function ue(e,t,n){var s=this&&this.__awaiter||function(e,t,n,s){return new(n||(n=Promise))((function(o,i){function r(e){try{a(s.next(e))}catch(e){i(e)}}function c(e){try{a(s.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,c)}a((s=s.apply(e,t||[])).next())}))};let o,i,r={miroUrl:null};const c=new q({onClientHasJoined:e=>{},onClientHasLeft:e=>(e=>{e!==o.clientUuid||r.miroUrl||c.stopApp()})(e),onReceiveMessageAsHost:e=>e,onReceiveMessageAsClient:e=>{(e=>{s(void 0,void 0,void 0,(function*(){switch(e.type){case"receive-miro-url":console.log("Received a message from Kosy: ",e),n(0,r.miroUrl=e.payload,r)}}))})(e)},onRequestState:()=>r,onProvideState:e=>(e=>{n(0,r=null!=e?e:r)})(e)});c.startApp().then((e=>{var t;n(1,o=e.clients[e.initializerClientUuid]),n(2,i=e.clients[e.currentClientUuid]),n(0,r=null!==(t=e.currentAppState)&&void 0!==t?t:r)}));let a=e=>{switch(e.type){case"miro-url-picked":c.relayMessage({type:"receive-miro-url",payload:e.payload});break;case"picking-canceled":c.stopApp()}};return[r,o,i,a,e=>a(e.detail)]}new class extends J{constructor(e){super(),B(this,e,ue,le,i,{})}}({target:document.getElementById("container"),props:{}})})()})();