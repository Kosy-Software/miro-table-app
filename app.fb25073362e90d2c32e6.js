(()=>{"use strict";(()=>{function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function s(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function r(t){return 0===Object.keys(t).length}function c(t,e){t.appendChild(e)}function a(t,e,n){t.insertBefore(e,n||null)}function l(t){t.parentNode.removeChild(t)}function u(t){return document.createElement(t)}function d(t){return document.createTextNode(t)}function p(){return d(" ")}function f(){return d("")}function m(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}let h;function $(t){h=t}new Set,new Set;const g=[],y=[],v=[],b=[],w=Promise.resolve();let k=!1;function _(t){v.push(t)}let x=!1;const C=new Set;function E(){if(!x){x=!0;do{for(let t=0;t<g.length;t+=1){const e=g[t];$(e),A(e.$$)}for($(null),g.length=0;y.length;)y.pop()();for(let t=0;t<v.length;t+=1){const e=v[t];C.has(e)||(C.add(e),e())}v.length=0}while(g.length);for(;b.length;)b.pop()();k=!1,x=!1,C.clear()}}function A(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(_)}}const M=new Set;let T,U;function S(){T={r:0,c:[],p:T}}function L(){T.r||o(T.c),T=T.p}function H(t,e){t&&t.i&&(M.delete(t),t.i(e))}function N(t,e,n,o){if(t&&t.o){if(M.has(t))return;M.add(t),T.c.push((()=>{M.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}}function K(t){t&&t.c()}function j(t,n,i,r){const{fragment:c,on_mount:a,on_destroy:l,after_update:u}=t.$$;c&&c.m(n,i),r||_((()=>{const n=a.map(e).filter(s);l?l.push(...n):o(n),t.$$.on_mount=[]})),u.forEach(_)}function J(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function P(e,s,i,r,c,a,u=[-1]){const d=h;$(e);const p=e.$$={fragment:null,ctx:null,props:a,update:t,not_equal:c,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(d?d.$$.context:s.context||[]),callbacks:n(),dirty:u,skip_bound:!1};let f=!1;if(p.ctx=i?i(e,s.props||{},((t,n,...o)=>{const s=o.length?o[0]:n;return p.ctx&&c(p.ctx[t],p.ctx[t]=s)&&(!p.skip_bound&&p.bound[t]&&p.bound[t](s),f&&function(t,e){-1===t.$$.dirty[0]&&(g.push(t),k||(k=!0,w.then(E)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}(e,t)),n})):[],p.update(),f=!0,o(p.before_update),p.fragment=!!r&&r(p.ctx),s.target){if(s.hydrate){const t=(m=s.target,Array.from(m.childNodes));p.fragment&&p.fragment.l(t),t.forEach(l)}else p.fragment&&p.fragment.c();s.intro&&H(e.$$.fragment),j(e,s.target,s.anchor,s.customElement),E()}var m;$(d)}"undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global,new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]),"function"==typeof HTMLElement&&(U=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const{on_mount:t}=this.$$;this.$$.on_disconnect=t.map(e).filter(s);for(const t in this.$$.slotted)this.appendChild(this.$$.slotted[t])}attributeChangedCallback(t,e,n){this[t]=n}disconnectedCallback(){o(this.$$.on_disconnect)}$destroy(){J(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){this.$$set&&!r(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}});class q{$destroy(){J(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){this.$$set&&!r(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}class O{constructor(t){this.kosyClient=window.parent,this.kosyApp=t}startApp(){return new Promise(((t,e)=>{window.addEventListener("message",(e=>{let n=e.data;switch(n.type){case"receive-initial-info":t(n.payload);break;case"client-has-joined":this.kosyApp.onClientHasJoined(n.payload);break;case"client-has-left":this.kosyApp.onClientHasLeft(n.clientUuid);break;case"get-app-state":const e=this.kosyApp.onRequestState();this._sendMessageToKosy({type:"receive-app-state",payload:e,clientUuids:n.clientUuids});break;case"set-app-state":this.kosyApp.onProvideState(n.state);break;case"receive-message":this.kosyApp.onReceiveMessage(n.payload)}})),this._sendMessageToKosy({type:"ready-and-listening"})}))}stopApp(){this._sendMessageToKosy({type:"stop-app"})}relayMessage(t){this._sendMessageToKosy({type:"relay-message",payload:t})}_sendMessageToKosy(t){this.kosyClient.postMessage(t,"*")}}function R(e){let n,o,s;return{c(){n=u("div"),o=u("iframe"),m(o,"title","miro board"),o.src!==(s=e[0])&&m(o,"src",s),m(n,"class","viewing")},m(t,e){a(t,n,e),c(n,o)},p(t,[e]){1&e&&o.src!==(s=t[0])&&m(o,"src",s)},i:t,o:t,d(t){t&&l(n)}}}function z(t,e,n){let{url:o}=e;return t.$$set=t=>{"url"in t&&n(0,o=t.url)},[o]}const B=class extends q{constructor(t){super(),P(this,t,z,R,i,{url:0})}},I=JSON.parse('{"J":{"I":"3074457356743178263","E":"https://advjhn6mca.execute-api.eu-central-1.amazonaws.com/get-miro-jwt-token"}}');function W(e){let n,o,s,i,r,d,f,h;return{c(){n=u("div"),o=u("div"),o.innerHTML="<h3>Embed Miro</h3>",s=p(),i=u("div"),r=p(),d=u("button"),d.textContent="Select a miro board",m(i,"class","gap"),m(d,"id","open-picker"),m(n,"class","picking")},m(t,l){var u,p,m,$;a(t,n,l),c(n,o),c(n,s),c(n,i),c(n,r),c(n,d),f||(u=d,p="click",m=e[0],u.addEventListener(p,m,$),h=()=>u.removeEventListener(p,m,$),f=!0)},p:t,i:t,o:t,d(t){t&&l(n),f=!1,h()}}}function D(t){const e=function(){const t=function(){if(!h)throw new Error("Function called outside component initialization");return h}();return(e,n)=>{const o=t.$$.callbacks[e];if(o){const s=function(t,e){const n=document.createEvent("CustomEvent");return n.initCustomEvent(t,!1,!1,e),n}(e,n);o.slice().forEach((e=>{e.call(t,s)}))}}}();return[()=>{window.miroBoardsPicker.open({clientId:I.J.I,action:"select",allowCreateAnonymousBoards:!0,getToken:()=>fetch(I.J.E).then((t=>t.text())),success:t=>{console.log("on success",t),e("message",{type:"miro-url-picked",payload:`https://miro.com/app/live-embed/${t.id}`})},error:t=>{console.log("on error",t)},cancel:()=>{console.log("on cancel")}})}]}const F=class extends q{constructor(t){super(),P(this,t,D,W,i,{})}};function G(e){let n,o,s,i,r,f,h,$,g,y,v;return{c(){n=u("div"),o=u("h3"),o.textContent="Miro sharing",s=p(),i=u("p"),r=d("Waiting for "),f=d(e[0]),h=d(" to pick a file"),$=p(),g=u("div"),y=p(),v=u("div"),v.innerHTML='<img alt="waiting" src="assets/waiting.svg"/>',m(g,"class","gap"),m(v,"class","img-container"),m(n,"class","waiting")},m(t,e){a(t,n,e),c(n,o),c(n,s),c(n,i),c(i,r),c(i,f),c(i,h),c(n,$),c(n,g),c(n,y),c(n,v)},p(t,[e]){var n,o;1&e&&(n=f,o=""+(o=t[0]),n.wholeText!==o&&(n.data=o))},i:t,o:t,d(t){t&&l(n)}}}function Q(t,e,n){let{name:o}=e;return t.$$set=t=>{"name"in t&&n(0,o=t.name)},[o]}const V=class extends q{constructor(t){super(),P(this,t,Q,G,i,{name:0})}};function X(e){let n;return{c(){n=u("p"),n.textContent="Waiting for Kosy..."},m(t,e){a(t,n,e)},p:t,i:t,o:t,d(t){t&&l(n)}}}function Y(t){let e,n,o,s;const i=[et,tt,Z],r=[];function c(t,e){return t[0].miroUrl?0:t[1].clientUuid===t[2].clientUuid?1:2}return e=c(t),n=r[e]=i[e](t),{c(){n.c(),o=f()},m(t,n){r[e].m(t,n),a(t,o,n),s=!0},p(t,s){let a=e;e=c(t),e===a?r[e].p(t,s):(S(),N(r[a],1,1,(()=>{r[a]=null})),L(),n=r[e],n?n.p(t,s):(n=r[e]=i[e](t),n.c()),H(n,1),n.m(o.parentNode,o))},i(t){s||(H(n),s=!0)},o(t){N(n),s=!1},d(t){r[e].d(t),t&&l(o)}}}function Z(t){let e,n;return e=new V({props:{name:t[1].clientName}}),{c(){K(e.$$.fragment)},m(t,o){j(e,t,o),n=!0},p(t,n){const o={};2&n&&(o.name=t[1].clientName),e.$set(o)},i(t){n||(H(e.$$.fragment,t),n=!0)},o(t){N(e.$$.fragment,t),n=!1},d(t){J(e,t)}}}function tt(e){let n,o;return n=new F({}),n.$on("message",e[4]),{c(){K(n.$$.fragment)},m(t,e){j(n,t,e),o=!0},p:t,i(t){o||(H(n.$$.fragment,t),o=!0)},o(t){N(n.$$.fragment,t),o=!1},d(t){J(n,t)}}}function et(t){let e,n;return e=new B({props:{url:t[0].miroUrl}}),{c(){K(e.$$.fragment)},m(t,o){j(e,t,o),n=!0},p(t,n){const o={};1&n&&(o.url=t[0].miroUrl),e.$set(o)},i(t){n||(H(e.$$.fragment,t),n=!0)},o(t){N(e.$$.fragment,t),n=!1},d(t){J(e,t)}}}function nt(t){let e,n,o,s;const i=[Y,X],r=[];function c(t,e){return t[1]&&t[2]?0:1}return e=c(t),n=r[e]=i[e](t),{c(){n.c(),o=f()},m(t,n){r[e].m(t,n),a(t,o,n),s=!0},p(t,[s]){let a=e;e=c(t),e===a?r[e].p(t,s):(S(),N(r[a],1,1,(()=>{r[a]=null})),L(),n=r[e],n?n.p(t,s):(n=r[e]=i[e](t),n.c()),H(n,1),n.m(o.parentNode,o))},i(t){s||(H(n),s=!0)},o(t){N(n),s=!1},d(t){r[e].d(t),t&&l(o)}}}function ot(t,e,n){var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))((function(s,i){function r(t){try{a(o.next(t))}catch(t){i(t)}}function c(t){try{a(o.throw(t))}catch(t){i(t)}}function a(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,c)}a((o=o.apply(t,e||[])).next())}))};let s,i,r={miroUrl:null},c=t=>{n(0,r=t),this.renderComponent()},a=t=>{t!==this.initializer.clientUuid||this.state.googleDriveUrl||l.stopApp()};const l=new O({onClientHasJoined:t=>{},onClientHasLeft:t=>a(t),onReceiveMessage:t=>{(t=>{o(void 0,void 0,void 0,(function*(){switch(t.type){case"receive-miro-url":console.log("Received a message from Kosy: ",t),n(0,r.miroUrl=t.payload,r)}}))})(t)},onRequestState:()=>r,onProvideState:t=>c(t)});l.startApp().then((t=>{n(1,s=t.clients[t.initializerClientUuid]),n(2,i=t.clients[t.currentClientUuid]),n(0,r=t.currentAppState)}));let u=t=>{switch(t.type){case"miro-url-picked":l.relayMessage({type:"receive-miro-url",payload:t.payload});break;case"picking-canceled":l.stopApp()}};return[r,s,i,u,t=>u(t.detail)]}new class extends q{constructor(t){super(),P(this,t,ot,nt,i,{})}}({target:document.getElementById("container"),props:{}})})()})();