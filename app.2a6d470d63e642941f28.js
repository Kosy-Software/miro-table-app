(()=>{"use strict";(()=>{function e(){}function t(e){return e()}function n(){return Object.create(null)}function o(e){e.forEach(t)}function s(e){return"function"==typeof e}function i(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function r(e){return 0===Object.keys(e).length}function c(e,t){e.appendChild(t)}function a(e,t,n){e.insertBefore(t,n||null)}function l(e){e.parentNode.removeChild(e)}function u(e){return document.createElement(e)}function d(e){return document.createTextNode(e)}function p(){return d(" ")}function f(){return d("")}function m(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}let h;function $(e){h=e}new Set,new Set;const g=[],y=[],v=[],b=[],w=Promise.resolve();let k=!1;function _(e){v.push(e)}let x=!1;const C=new Set;function E(){if(!x){x=!0;do{for(let e=0;e<g.length;e+=1){const t=g[e];$(t),A(t.$$)}for($(null),g.length=0;y.length;)y.pop()();for(let e=0;e<v.length;e+=1){const t=v[e];C.has(t)||(C.add(t),t())}v.length=0}while(g.length);for(;b.length;)b.pop()();k=!1,x=!1,C.clear()}}function A(e){if(null!==e.fragment){e.update(),o(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(_)}}const M=new Set;let T,U;function S(){T={r:0,c:[],p:T}}function L(){T.r||o(T.c),T=T.p}function H(e,t){e&&e.i&&(M.delete(e),e.i(t))}function N(e,t,n,o){if(e&&e.o){if(M.has(e))return;M.add(e),T.c.push((()=>{M.delete(e),o&&(n&&e.d(1),o())})),e.o(t)}}function j(e){e&&e.c()}function J(e,n,i,r){const{fragment:c,on_mount:a,on_destroy:l,after_update:u}=e.$$;c&&c.m(n,i),r||_((()=>{const n=a.map(t).filter(s);l?l.push(...n):o(n),e.$$.on_mount=[]})),u.forEach(_)}function K(e,t){const n=e.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function P(t,s,i,r,c,a,u=[-1]){const d=h;$(t);const p=t.$$={fragment:null,ctx:null,props:a,update:e,not_equal:c,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(d?d.$$.context:s.context||[]),callbacks:n(),dirty:u,skip_bound:!1};let f=!1;if(p.ctx=i?i(t,s.props||{},((e,n,...o)=>{const s=o.length?o[0]:n;return p.ctx&&c(p.ctx[e],p.ctx[e]=s)&&(!p.skip_bound&&p.bound[e]&&p.bound[e](s),f&&function(e,t){-1===e.$$.dirty[0]&&(g.push(e),k||(k=!0,w.then(E)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}(t,e)),n})):[],p.update(),f=!0,o(p.before_update),p.fragment=!!r&&r(p.ctx),s.target){if(s.hydrate){const e=(m=s.target,Array.from(m.childNodes));p.fragment&&p.fragment.l(e),e.forEach(l)}else p.fragment&&p.fragment.c();s.intro&&H(t.$$.fragment),J(t,s.target,s.anchor,s.customElement),E()}var m;$(d)}"undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global,new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]),"function"==typeof HTMLElement&&(U=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const{on_mount:e}=this.$$;this.$$.on_disconnect=e.map(t).filter(s);for(const e in this.$$.slotted)this.appendChild(this.$$.slotted[e])}attributeChangedCallback(e,t,n){this[e]=n}disconnectedCallback(){o(this.$$.on_disconnect)}$destroy(){K(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){this.$$set&&!r(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}});class q{$destroy(){K(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){this.$$set&&!r(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}class O{constructor(e){this.kosyClient=window.parent,this.kosyApp=e}startApp(){return new Promise(((e,t)=>{window.addEventListener("message",(t=>{let n=t.data;switch(n.type){case"receive-initial-info":e(n.payload);break;case"client-has-joined":this.kosyApp.onClientHasJoined(n.payload);break;case"client-has-left":this.kosyApp.onClientHasLeft(n.clientUuid);break;case"get-app-state":const t=this.kosyApp.onRequestState();this._sendMessageToKosy({type:"receive-app-state",payload:t,clientUuids:n.clientUuids});break;case"set-app-state":this.kosyApp.onProvideState(n.state);break;case"receive-message":this.kosyApp.onReceiveMessage(n.payload)}})),this._sendMessageToKosy({type:"ready-and-listening"})}))}stopApp(){this._sendMessageToKosy({type:"stop-app"})}relayMessage(e){this._sendMessageToKosy({type:"relay-message",payload:e})}_sendMessageToKosy(e){this.kosyClient.postMessage(e,"*")}}function R(t){let n,o;return{c(){n=u("iframe"),m(n,"title","miro board"),n.src!==(o=t[0])&&m(n,"src",o),m(n,"class","svelte-tbe2c")},m(e,t){a(e,n,t)},p(e,[t]){1&t&&n.src!==(o=e[0])&&m(n,"src",o)},i:e,o:e,d(e){e&&l(n)}}}function B(e,t,n){let{url:o}=t;return e.$$set=e=>{"url"in e&&n(0,o=e.url)},[o]}const I=class extends q{constructor(e){super(),P(this,e,B,R,i,{url:0})}},z=JSON.parse('{"J":{"I":"3074457356743178263","E":"https://advjhn6mca.execute-api.eu-central-1.amazonaws.com/get-miro-jwt-token"}}');function F(t){let n,o,s,i,r,d,f,h;return{c(){n=u("div"),o=u("div"),o.innerHTML="<h3>Embed Miro</h3>",s=p(),i=u("div"),r=p(),d=u("button"),d.textContent="Select a miro board",m(o,"class","svelte-1y5yvi7"),m(i,"class","gap svelte-1y5yvi7"),m(d,"id","open-picker"),m(n,"class","picking svelte-1y5yvi7")},m(e,l){var u,p,m,$;a(e,n,l),c(n,o),c(n,s),c(n,i),c(n,r),c(n,d),f||(u=d,p="click",m=t[0],u.addEventListener(p,m,$),h=()=>u.removeEventListener(p,m,$),f=!0)},p:e,i:e,o:e,d(e){e&&l(n),f=!1,h()}}}function W(e){const t=function(){const e=function(){if(!h)throw new Error("Function called outside component initialization");return h}();return(t,n)=>{const o=e.$$.callbacks[t];if(o){const s=function(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}(t,n);o.slice().forEach((t=>{t.call(e,s)}))}}}();return[()=>{window.miroBoardsPicker.open({clientId:z.J.I,action:"select",allowCreateAnonymousBoards:!0,getToken:()=>fetch(z.J.E).then((e=>e.text())),success:e=>{console.log("on success",e),t("message",{type:"miro-url-picked",payload:`https://miro.com/app/live-embed/${e.id}`})},error:e=>{console.log("on error",e)},cancel:()=>{console.log("on cancel")}})}]}const D=class extends q{constructor(e){super(),P(this,e,W,F,i,{})}};function G(t){let n,o,s,i,r,f,h,$,g,y,v;return{c(){n=u("div"),o=u("h3"),o.textContent="Miro sharing",s=p(),i=u("p"),r=d("Waiting for "),f=d(t[0]),h=d(" to pick a file"),$=p(),g=u("div"),y=p(),v=u("div"),v.innerHTML='<img alt="waiting" src="assets/waiting.svg"/>',m(g,"class","gap svelte-168y7ua"),m(v,"class","img-container svelte-168y7ua"),m(n,"class","waiting svelte-168y7ua")},m(e,t){a(e,n,t),c(n,o),c(n,s),c(n,i),c(i,r),c(i,f),c(i,h),c(n,$),c(n,g),c(n,y),c(n,v)},p(e,[t]){var n,o;1&t&&(n=f,o=""+(o=e[0]),n.wholeText!==o&&(n.data=o))},i:e,o:e,d(e){e&&l(n)}}}function Q(e,t,n){let{name:o}=t;return e.$$set=e=>{"name"in e&&n(0,o=e.name)},[o]}const V=class extends q{constructor(e){super(),P(this,e,Q,G,i,{name:0})}};function X(t){let n;return{c(){n=u("p")},m(e,t){a(e,n,t)},p:e,i:e,o:e,d(e){e&&l(n)}}}function Y(e){let t,n,o,s;const i=[te,ee,Z],r=[];function c(e,t){return e[0].miroUrl?0:e[1].clientUuid===e[2].clientUuid?1:2}return t=c(e),n=r[t]=i[t](e),{c(){n.c(),o=f()},m(e,n){r[t].m(e,n),a(e,o,n),s=!0},p(e,s){let a=t;t=c(e),t===a?r[t].p(e,s):(S(),N(r[a],1,1,(()=>{r[a]=null})),L(),n=r[t],n?n.p(e,s):(n=r[t]=i[t](e),n.c()),H(n,1),n.m(o.parentNode,o))},i(e){s||(H(n),s=!0)},o(e){N(n),s=!1},d(e){r[t].d(e),e&&l(o)}}}function Z(e){let t,n;return t=new V({props:{name:e[1].clientName}}),{c(){j(t.$$.fragment)},m(e,o){J(t,e,o),n=!0},p(e,n){const o={};2&n&&(o.name=e[1].clientName),t.$set(o)},i(e){n||(H(t.$$.fragment,e),n=!0)},o(e){N(t.$$.fragment,e),n=!1},d(e){K(t,e)}}}function ee(t){let n,o;return n=new D({}),n.$on("message",t[4]),{c(){j(n.$$.fragment)},m(e,t){J(n,e,t),o=!0},p:e,i(e){o||(H(n.$$.fragment,e),o=!0)},o(e){N(n.$$.fragment,e),o=!1},d(e){K(n,e)}}}function te(e){let t,n;return t=new I({props:{url:e[0].miroUrl}}),{c(){j(t.$$.fragment)},m(e,o){J(t,e,o),n=!0},p(e,n){const o={};1&n&&(o.url=e[0].miroUrl),t.$set(o)},i(e){n||(H(t.$$.fragment,e),n=!0)},o(e){N(t.$$.fragment,e),n=!1},d(e){K(t,e)}}}function ne(e){let t,n,o,s;const i=[Y,X],r=[];function c(e,t){return e[1]&&e[2]?0:1}return t=c(e),n=r[t]=i[t](e),{c(){n.c(),o=f()},m(e,n){r[t].m(e,n),a(e,o,n),s=!0},p(e,[s]){let a=t;t=c(e),t===a?r[t].p(e,s):(S(),N(r[a],1,1,(()=>{r[a]=null})),L(),n=r[t],n?n.p(e,s):(n=r[t]=i[t](e),n.c()),H(n,1),n.m(o.parentNode,o))},i(e){s||(H(n),s=!0)},o(e){N(n),s=!1},d(e){r[t].d(e),e&&l(o)}}}function oe(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(s,i){function r(e){try{a(o.next(e))}catch(e){i(e)}}function c(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,c)}a((o=o.apply(e,t||[])).next())}))};let s,i,r={miroUrl:null};const c=new O({onClientHasJoined:e=>{},onClientHasLeft:e=>(e=>{e!==s.clientUuid||r.miroUrl||c.stopApp()})(e),onReceiveMessage:e=>{(e=>{o(void 0,void 0,void 0,(function*(){switch(e.type){case"receive-miro-url":console.log("Received a message from Kosy: ",e),n(0,r.miroUrl=e.payload,r)}}))})(e)},onRequestState:()=>r,onProvideState:e=>(e=>{n(0,r=null!=e?e:r)})(e)});c.startApp().then((e=>{n(1,s=e.clients[e.initializerClientUuid]),n(2,i=e.clients[e.currentClientUuid]),n(0,r=e.currentAppState)}));let a=e=>{switch(e.type){case"miro-url-picked":c.relayMessage({type:"receive-miro-url",payload:e.payload});break;case"picking-canceled":c.stopApp()}};return[r,s,i,a,e=>a(e.detail)]}new class extends q{constructor(e){super(),P(this,e,oe,ne,i,{})}}({target:document.getElementById("container"),props:{}})})()})();